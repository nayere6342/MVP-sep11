<!DOCTYPE html>
<html>
<head>
	<title>Jump!</title>
</head>
<body>
	<script src="main.js"></script>

	<script type="module">
	import kaboom from "https://unpkg.com/kaboom@3000.0.1/dist/kaboom.mjs";



			kaboom({
				background: [0]
			})

			// Load assets
			loadSprite("player", "/sprites/8bit-player.png")
			loadSprite("coin", "/sprites/8bit-coin.png")
			loadSprite("base", "/sprites/8bit-baseline.png")
			loadSprite("plate", "/sprites/8bit-plateform.png")
			loadSprite("fire", "/sprites/8bit-fire.png")
			loadSprite("backdrop", "/sprites/8bit-backdrop.png")

			const SPEED = 520
			setGravity(1600)

			// const main = add([
			// text("Jamp!"),
			// pos(700,200),
			// ])


			const score = add([
			text("Score:"),
			pos(24, 24),
			{ value: 0 },
		])


			const player = add([
				sprite("player"),
				scale(.1),
				pos(100, 100),
				color(),
				rotate(0),
				area(),
				body(),
			])



			spawnMap();
				add([
				sprite("plate"),
				scale(.2),
				pos(40,220),
				area(),
				body({ isStatic: true }),
				"plate",
			])




			onKeyDown("left", () => { 	// all the player movement [arrow keys]
				player.move(-SPEED, 0)
			})

			onKeyDown("right", () => {
				player.move(SPEED, 0)
			})

			onKeyPress("up", () => {
			if (player.isGrounded()) {
				player.jump()
			}
		})

			onKeyDown("a", () => { 	// all the player movement [w,a,d]
				player.move(-SPEED, 0)
			})

			onKeyDown("d", () => {
				player.move(SPEED, 0)
			})

			onKeyPress("w", () => {
			if (player.isGrounded()) {
				player.jump()
			}
		})


			function spawnMap() {
				add([
					sprite("base"), // get the base to come into frame
					scale(.3),
					area(),
					body({ isStatic: true }),
					pos(width(), height() - 10),
					anchor("botleft"),
					move(LEFT, 540),
					"base",
				]);
				wait(rand(.2, .2), () => {
					spawnMap();
				});
			}


			function spawnDead() {
				add([
					sprite("fire"),
					scale(.1),
					area(),
					body({ isStatic: true }),
					pos(width(), height() - 200),
					anchor("botleft"),
					move(LEFT, 540),
					"fire",
				]);
				wait(rand(2, 1.8), () => {
					spawnDead();
				});
			}

				spawnDead();
				add([
				sprite("fire"),
				scale(.4),
				pos(500,-2000),
				area(),
				body({ isStatic: true }),
				"fire",
			])



			function spawnScore() {
				add([
					sprite("coin"),
					scale(.1),
					area(),
					body({ isStatic: true }),
					pos(width(), height() - 220),
					anchor("botleft"),
					move(LEFT, 440),
					"coin",
				]);
				wait(rand(3, 3), () => {
					spawnScore();
				});
			}

				spawnScore();
				add([
				sprite("coin"),
				scale(.4),
				pos(500,-2000),
				area(),
				body({ isStatic: true }),
				"coin",
			])



			function spawnHit() {
				add([
					sprite("backdrop"),
					scale(.1),
					area(),
					body({ isStatic: false }),
					pos(width(), height() - 220),
					anchor("botleft"),
					move(LEFT, 440),
					"backdrop",
				]);
				wait(rand(10, 5), () => {
					spawnHit();
				});
			}

				spawnHit();
				add([
				sprite("backdrop"),
				scale(.4),
				pos(-900,-2000),
				area(),
				body({ isStatic: false }),
				"backdrop",
			])





			player.onCollide("fire", (enemy) => {
				destroy(player)
				const die = add([
					text("[ GAME OVER ]"),
					pos(700,200),
				])
			})

			player.onCollide("coin", (enemy) => {
				score.value += 1
				score.text = "Score:" + score.value


			})


			player.onCollideUpdate("coin", (coin) => {
				destroy(coin)
			})



		</script>

</body>
</html>
